# ScriptToFrame å¼€å‘æŒ‡å—

## æ¦‚è¿°

æœ¬æ–‡æ¡£ä¸ºæ–°å¼€å‘è€…æä¾›è¯¦ç»†çš„å¼€å‘ç¯å¢ƒæ­å»ºã€ä»£ç è§„èŒƒã€è°ƒè¯•æ–¹æ³•å’Œè´¡çŒ®æŒ‡å—ï¼Œå¸®åŠ©å¿«é€Ÿä¸Šæ‰‹ScriptToFrameé¡¹ç›®å¼€å‘ã€‚

## æŠ€æœ¯æ ˆæ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æŠ€æœ¯æ ˆæ¶æ„                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å‰ç«¯æŠ€æœ¯æ ˆ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     React       â”‚ â† UIç»„ä»¶åº“ (18.3.1)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     Next.js     â”‚ â† å…¨æ ˆæ¡†æ¶ (14.2.0)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   TypeScript    â”‚ â† ç±»å‹å®‰å…¨ (5.0.0)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Tailwind CSS   â”‚ â† åŸå­åŒ–CSS
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     Axios       â”‚ â† HTTPå®¢æˆ·ç«¯
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

åç«¯æŠ€æœ¯æ ˆ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Node.js API   â”‚ â† APIè·¯ç”±å¤„ç†
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   FastAPI       â”‚ â† Python Webæ¡†æ¶
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç«å±±å¼•æ“ SDK     â”‚ â† å›¾ç‰‡ç”Ÿæˆ
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  DeepSeek API   â”‚ â† å‰§æœ¬åˆ†æ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¼€å‘å·¥å…·:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ESLint     â”‚ â† ä»£ç æ£€æŸ¥
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    Prettier     â”‚ â† ä»£ç æ ¼å¼åŒ–
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       Git       â”‚ â† ç‰ˆæœ¬æ§åˆ¶
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      VS Code    â”‚ â† æ¨èç¼–è¾‘å™¨
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å¼€å‘ç¯å¢ƒæ­å»º

### 1. ç³»ç»Ÿè¦æ±‚

**æ“ä½œç³»ç»Ÿ**: Windows 10/11, macOS 12+, Ubuntu 20.04+

**å¿…éœ€è½¯ä»¶**:
```bash
Node.js: 18.0.0+ (æ¨è18.19.0)
Python: 3.11.0+ (æ¨è3.11.7)
Git: 2.40.0+
npm: 9.0.0+ (æˆ– yarn 1.22.0+)
```

**æ¨èè½¯ä»¶**:
```bash
VS Code: æœ€æ–°ç‰ˆæœ¬
Docker: 24.0.0+ (å¯é€‰)
Postman: APIæµ‹è¯•å·¥å…·
```

### 2. IDEé…ç½®

**VS Codeæ¨èæ’ä»¶**:
```json
{
  "recommendations": [
    // JavaScript/TypeScript
    "ms-vscode.vscode-typescript-next",
    "bradlc.vscode-tailwindcss",
    "ms-vscode.vscode-json",

    // Python
    "ms-python.python",
    "ms-python.autopep8",
    "ms-python.pylint",

    // React/Next.js
    "ms-vscode.vscode-react-native",
    "formulahendry.auto-rename-tag",
    "christian-kohler.path-intellisense",

    // ä»£ç è´¨é‡
    "esbenp.prettier-vscode",
    "ms-vscode.vscode-eslint",
    "streetsidesoftware.code-spell-checker",

    // å·¥å…·
    "ms-vscode.vscode-git-graph",
    "ms-vscode.hexdump",
    "ms-vscode.live-server"
  ]
}
```

**VS Codeç”¨æˆ·è®¾ç½® (.vscode/settings.json)**:
```json
{
  "editor.formatOnSave": true,
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  },
  "typescript.preferences.importModuleSpecifier": "relative",
  "emmet.includeLanguages": {
    "javascript": "javascriptreact"
  },
  "files.associations": {
    "*.jsx": "javascriptreact",
    "*.tsx": "typescriptreact"
  },
  "python.defaultInterpreterPath": "./python-backend/venv/bin/python",
  "python.formatting.provider": "autopep8",
  "python.linting.pylintEnabled": true,
  "[javascript]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },
  "[typescript]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },
  "[python]": {
    "editor.defaultFormatter": "ms-python.autopep8"
  }
}
```

### 3. é¡¹ç›®å…‹éš†å’Œåˆå§‹åŒ–

**å…‹éš†é¡¹ç›®**:
```bash
# å…‹éš†ä»£ç åº“
git clone <repository-url>
cd script-to-frame

# æŸ¥çœ‹é¡¹ç›®ç»“æ„
tree -I 'node_modules|venv|__pycache__' -L 3
```

**ç¯å¢ƒé…ç½®**:
```bash
# 1. å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env .env.local

# 2. ç¼–è¾‘ç¯å¢ƒå˜é‡ (æ·»åŠ çœŸå®çš„APIå¯†é’¥)
nano .env.local  # æˆ–ä½¿ç”¨VS Code: code .env.local
```

**å‰ç«¯ä¾èµ–å®‰è£…**:
```bash
# å®‰è£…Node.jsä¾èµ–
npm install

# éªŒè¯å®‰è£…
npm list --depth=0

# æ£€æŸ¥å®‰å…¨æ¼æ´
npm audit
```

**Pythonåç«¯ç¯å¢ƒ**:
```bash
cd python-backend

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source venv/bin/activate  # Linux/macOS
# æˆ–
venv\Scripts\activate     # Windows

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# éªŒè¯å®‰è£…
pip list

# è¿”å›é¡¹ç›®æ ¹ç›®å½•
cd ..
```

### 4. å¼€å‘æœåŠ¡å™¨å¯åŠ¨

**æ–¹å¼1: æ‰‹åŠ¨å¯åŠ¨ (æ¨èç”¨äºå¼€å‘)**:
```bash
# ç»ˆç«¯1 - å¯åŠ¨Pythonåç«¯
cd python-backend
source venv/bin/activate
uvicorn main:app --host 0.0.0.0 --port 8081 --reload

# ç»ˆç«¯2 - å¯åŠ¨å‰ç«¯
npm run dev
```

**æ–¹å¼2: ä½¿ç”¨å¯åŠ¨è„šæœ¬**:
```bash
# Linux/macOS
./start.sh

# Windows
start.bat
```

**éªŒè¯æœåŠ¡**:
```bash
# æ£€æŸ¥å‰ç«¯æœåŠ¡
curl http://localhost:3000

# æ£€æŸ¥Pythonåç«¯æœåŠ¡
curl http://localhost:8081/api/health

# æ£€æŸ¥APIé›†æˆ
curl -X POST http://localhost:3000/api/intelligent-analyze-script \
  -H "Content-Type: application/json" \
  -d '{"script": "æµ‹è¯•å‰§æœ¬", "sceneCount": 3, "style": "anime", "genre": "general"}'
```

## ä»£ç ç»“æ„å’Œè§„èŒƒ

### 1. é¡¹ç›®ç›®å½•ç»“æ„

```
script-to-frame/
â”œâ”€â”€ components/                # Reactç»„ä»¶
â”‚   â”œâ”€â”€ ScriptInput.jsx       # å‰§æœ¬è¾“å…¥ç»„ä»¶
â”‚   â”œâ”€â”€ ControlPanel.jsx      # æ§åˆ¶é¢æ¿ç»„ä»¶
â”‚   â”œâ”€â”€ StoryboardDisplay.jsx # åˆ†é•œæ˜¾ç¤ºç»„ä»¶
â”‚   â””â”€â”€ ProgressBar.js        # è¿›åº¦æ¡ç»„ä»¶
â”œâ”€â”€ pages/                    # Next.jsé¡µé¢å’ŒAPIè·¯ç”±
â”‚   â”œâ”€â”€ index.js             # ä¸»é¡µé¢
â”‚   â”œâ”€â”€ _app.js              # åº”ç”¨é…ç½®
â”‚   â””â”€â”€ api/                 # APIè·¯ç”±
â”‚       â”œâ”€â”€ intelligent-analyze-script.js  # AIåˆ†æAPI
â”‚       â”œâ”€â”€ generate-image-python.js       # å›¾ç‰‡ç”Ÿæˆä»£ç†
â”‚       â””â”€â”€ generate-all-images.js         # æ‰¹é‡ç”ŸæˆAPI
â”œâ”€â”€ lib/                      # å·¥å…·åº“å’ŒAPIé›†æˆ
â”‚   â”œâ”€â”€ claude-api.js        # Claude APIé›†æˆ
â”‚   â”œâ”€â”€ volcengine-api.js    # ç«å±±å¼•æ“APIé›†æˆ
â”‚   â””â”€â”€ image-utils.js       # å›¾ç‰‡å¤„ç†å·¥å…·
â”œâ”€â”€ styles/                  # æ ·å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ globals.css          # å…¨å±€æ ·å¼
â”‚   â””â”€â”€ components.css       # ç»„ä»¶æ ·å¼
â”œâ”€â”€ config/                  # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ api-config.js        # APIé…ç½®
â”œâ”€â”€ types/                   # TypeScriptç±»å‹å®šä¹‰
â”‚   â””â”€â”€ index.ts             # ç±»å‹å®šä¹‰
â”œâ”€â”€ python-backend/          # Pythonåç«¯æœåŠ¡
â”‚   â”œâ”€â”€ main.py             # FastAPIä¸»å…¥å£
â”‚   â”œâ”€â”€ requirements.txt    # Pythonä¾èµ–
â”‚   â””â”€â”€ venv/               # Pythonè™šæ‹Ÿç¯å¢ƒ
â”œâ”€â”€ docs/                    # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ logs/                    # æ—¥å¿—æ–‡ä»¶
â”œâ”€â”€ scripts/                 # å·¥å…·è„šæœ¬
â”œâ”€â”€ .env                     # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ .env.local              # æœ¬åœ°ç¯å¢ƒå˜é‡ (ä¸æäº¤åˆ°Git)
â”œâ”€â”€ package.json            # Node.jsä¾èµ–å’Œè„šæœ¬
â”œâ”€â”€ tailwind.config.js      # Tailwind CSSé…ç½®
â”œâ”€â”€ next.config.js          # Next.jsé…ç½®
â””â”€â”€ README.md               # é¡¹ç›®è¯´æ˜
```

### 2. ç¼–ç è§„èŒƒ

**JavaScript/TypeScriptè§„èŒƒ**:

```javascript
// âœ… è‰¯å¥½çš„ç»„ä»¶ç»“æ„
import { useState, useEffect } from 'react';
import PropTypes from 'prop-types';

/**
 * ScriptInput ç»„ä»¶ - å‰§æœ¬è¾“å…¥åŠŸèƒ½
 * @param {Object} props - ç»„ä»¶å±æ€§
 * @param {string} props.value - å½“å‰å‰§æœ¬å†…å®¹
 * @param {Function} props.onChange - å†…å®¹å˜åŒ–å›è°ƒ
 * @param {Function} props.onValidate - éªŒè¯å›è°ƒ
 */
const ScriptInput = ({ value, onChange, onValidate }) => {
  const [wordCount, setWordCount] = useState(0);
  const [isValid, setIsValid] = useState(true);

  // ä½¿ç”¨useEffectå¤„ç†å‰¯ä½œç”¨
  useEffect(() => {
    const words = value.trim().split(/\s+/).filter(word => word.length > 0);
    setWordCount(words.length);
  }, [value]);

  // äº‹ä»¶å¤„ç†å‡½æ•°å‘½åè§„èŒƒ
  const handleChange = (e) => {
    const newValue = e.target.value;

    // éªŒè¯é€»è¾‘
    const isValid = validateScript(newValue);
    setIsValid(isValid);

    // è§¦å‘å›è°ƒ
    onChange(newValue);
    onValidate?.(isValid);
  };

  // è¾…åŠ©å‡½æ•°
  const validateScript = (script) => {
    return script.length >= 20;
  };

  return (
    <div className="script-input">
      {/* ç»„ä»¶å†…å®¹ */}
    </div>
  );
};

// PropTypeså®šä¹‰
ScriptInput.propTypes = {
  value: PropTypes.string.isRequired,
  onChange: PropTypes.func.isRequired,
  onValidate: PropTypes.func
};

export default ScriptInput;
```

**Pythonä»£ç è§„èŒƒ**:

```python
"""
ScriptToFrame Pythonåç«¯ - å›¾ç‰‡ç”ŸæˆæœåŠ¡
"""

import os
import asyncio
import time
from typing import Optional, Dict, Any
from fastapi import FastAPI, HTTPException
from pydantic import BaseModel

# å¸¸é‡å®šä¹‰ (å¤§å†™)
REQ_KEY = "jimeng_t2i_v40"
MAX_POLL_TIMES = 150
POLL_INTERVAL = 2

# ç±»å‹å®šä¹‰
class ImageGenerationRequest(BaseModel):
    """å›¾ç‰‡ç”Ÿæˆè¯·æ±‚æ¨¡å‹"""
    prompt: str
    frame: Optional[Dict[str, Any]] = None

class ImageGenerationResponse(BaseModel):
    """å›¾ç‰‡ç”Ÿæˆå“åº”æ¨¡å‹"""
    success: bool
    data: Optional[Dict[str, Any]] = None
    error: Optional[str] = None

# å·¥å…·å‡½æ•°
def validate_prompt(prompt: str) -> bool:
    """
    éªŒè¯æç¤ºè¯æ ¼å¼

    Args:
        prompt: è¾“å…¥çš„æç¤ºè¯

    Returns:
        bool: éªŒè¯ç»“æœ
    """
    return len(prompt.strip()) > 0

async def generate_image_with_sdk(
    prompt: str,
    request_id: str = None
) -> str:
    """
    ä½¿ç”¨SDKç”Ÿæˆå›¾ç‰‡

    Args:
        prompt: å›¾ç‰‡ç”Ÿæˆæç¤ºè¯
        request_id: è¯·æ±‚IDï¼Œç”¨äºæ—¥å¿—è¿½è¸ª

    Returns:
        str: ç”Ÿæˆçš„å›¾ç‰‡URLæˆ–base64æ•°æ®

    Raises:
        HTTPException: å½“ç”Ÿæˆå¤±è´¥æ—¶æŠ›å‡º
    """
    if not request_id:
        request_id = f"img_{int(time.time())}"

    print(f"ğŸ¨ [Pythonåç«¯-{request_id}] å¼€å§‹ç”Ÿæˆå›¾ç‰‡")

    try:
        # å…·ä½“å®ç°
        result = await _call_volcengine_api(prompt)
        return result

    except Exception as error:
        print(f"âŒ [Pythonåç«¯-{request_id}] ç”Ÿæˆå¤±è´¥: {error}")
        raise HTTPException(
            status_code=500,
            detail=f"å›¾ç‰‡ç”Ÿæˆå¤±è´¥: {str(error)}"
        )

# ç§æœ‰å‡½æ•°ä½¿ç”¨ä¸‹åˆ’çº¿å‰ç¼€
async def _call_volcengine_api(prompt: str) -> str:
    """è°ƒç”¨ç«å±±å¼•æ“APIçš„ç§æœ‰å‡½æ•°"""
    # å®ç°ç»†èŠ‚
    pass
```

**å‘½åçº¦å®š**:

```javascript
// æ–‡ä»¶å‘½å (kebab-case)
intelligent-analyze-script.js
generate-image-python.js
api-config.js

// ç»„ä»¶å‘½å (PascalCase)
ScriptInput
ControlPanel
StoryboardDisplay

// å˜é‡å’Œå‡½æ•°å‘½å (camelCase)
const analysisResult = {};
const handleAnalyzeScript = () => {};

// å¸¸é‡å‘½å (SCREAMING_SNAKE_CASE)
const MAX_RETRY_ATTEMPTS = 3;
const API_TIMEOUT = 60000;

// CSSç±»å‘½å (kebab-case with BEM)
.cyber-button
.cyber-button--primary
.cyber-button__icon
```

### 3. ä»£ç è´¨é‡å·¥å…·

**ESLinté…ç½® (.eslintrc.json)**:
```json
{
  "extends": [
    "next/core-web-vitals",
    "eslint:recommended"
  ],
  "rules": {
    "no-unused-vars": "warn",
    "no-console": "off",
    "prefer-const": "error",
    "no-var": "error",
    "object-curly-spacing": ["error", "always"],
    "array-bracket-spacing": ["error", "never"],
    "comma-dangle": ["error", "never"],
    "quotes": ["error", "single"],
    "semi": ["error", "always"]
  },
  "env": {
    "browser": true,
    "node": true,
    "es6": true
  }
}
```

**Prettieré…ç½® (.prettierrc)**:
```json
{
  "semi": true,
  "trailingComma": "es5",
  "singleQuote": true,
  "printWidth": 80,
  "tabWidth": 2,
  "useTabs": false,
  "bracketSpacing": true,
  "arrowParens": "avoid",
  "endOfLine": "lf"
}
```

**Pythonä»£ç æ ¼å¼åŒ– (setup.cfg)**:
```ini
[flake8]
max-line-length = 88
extend-ignore = E203, W503
exclude = venv, __pycache__, .git

[autopep8]
max_line_length = 88
ignore = E203, W503
```

## è°ƒè¯•å’Œæµ‹è¯•

### 1. å‰ç«¯è°ƒè¯•

**React DevToolsä½¿ç”¨**:
```javascript
// åœ¨ç»„ä»¶ä¸­æ·»åŠ è°ƒè¯•ä¿¡æ¯
const ScriptInput = ({ value, onChange }) => {
  // æ·»åŠ è°ƒè¯•props
  useEffect(() => {
    console.log('ScriptInput rendered with:', { value });
  }, [value]);

  return <div>{/* ç»„ä»¶å†…å®¹ */}</div>;
};
```

**æµè§ˆå™¨è°ƒè¯•å·¥å…·**:
```javascript
// åœ¨ä»£ç ä¸­æ·»åŠ æ–­ç‚¹
const handleAnalyze = async () => {
  debugger; // æµè§ˆå™¨ä¼šåœ¨è¿™é‡Œæš‚åœ

  const result = await analyzeScript(script);
  console.log('åˆ†æç»“æœ:', result);
};

// ä½¿ç”¨console.tableæŸ¥çœ‹å¯¹è±¡
console.table(frames);

// ä½¿ç”¨console.timeæµ‹é‡æ€§èƒ½
console.time('APIè°ƒç”¨');
const result = await fetch('/api/analyze');
console.timeEnd('APIè°ƒç”¨');
```

**Next.jsè°ƒè¯•é…ç½®**:
```javascript
// next.config.js
/** @type {import('next').NextConfig} */
const nextConfig = {
  reactStrictMode: true,
  swcMinify: true,

  // å¼€å‘ç¯å¢ƒä¼˜åŒ–
  webpack: (config, { dev, isServer }) => {
    if (dev) {
      config.devtool = 'cheap-module-source-map';
    }
    return config;
  },

  // APIè·¯ç”±è°ƒè¯•
  async rewrites() {
    return [
      {
        source: '/api/debug/:path*',
        destination: '/api/:path*',
      },
    ];
  },
};

module.exports = nextConfig;
```

### 2. Pythonåç«¯è°ƒè¯•

**FastAPIè°ƒè¯•æ¨¡å¼**:
```python
# main.py
import logging
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware

# é…ç½®æ—¥å¿—
logging.basicConfig(
    level=logging.DEBUG,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)

app = FastAPI(debug=True)  # å¼€å¯è°ƒè¯•æ¨¡å¼

# æ·»åŠ è°ƒè¯•ä¸­é—´ä»¶
@app.middleware("http")
async def log_requests(request: Request, call_next):
    start_time = time.time()

    # è®°å½•è¯·æ±‚
    print(f"ğŸ” [DEBUG] {request.method} {request.url}")

    response = await call_next(request)

    # è®°å½•å“åº”æ—¶é—´
    process_time = time.time() - start_time
    print(f"â±ï¸ [DEBUG] å“åº”æ—¶é—´: {process_time:.3f}s")

    return response
```

**ä½¿ç”¨pdbè°ƒè¯•å™¨**:
```python
import pdb

async def generate_image_with_sdk(prompt: str):
    # è®¾ç½®æ–­ç‚¹
    pdb.set_trace()

    # è°ƒè¯•å˜é‡
    print(f"prompt: {prompt}")

    # ç»§ç»­æ‰§è¡Œ
    result = await call_api(prompt)
    return result
```

**VS Codeè°ƒè¯•é…ç½® (.vscode/launch.json)**:
```json
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Debug Next.js",
      "type": "node",
      "request": "launch",
      "program": "${workspaceFolder}/node_modules/.bin/next",
      "args": ["dev"],
      "console": "integratedTerminal",
      "env": {
        "NODE_OPTIONS": "--inspect"
      }
    },
    {
      "name": "Debug Python Backend",
      "type": "python",
      "request": "launch",
      "program": "${workspaceFolder}/python-backend/main.py",
      "cwd": "${workspaceFolder}/python-backend",
      "env": {
        "PYTHONPATH": "${workspaceFolder}/python-backend"
      },
      "console": "integratedTerminal"
    }
  ]
}
```

### 3. APIæµ‹è¯•

**Postmané›†åˆç¤ºä¾‹**:
```json
{
  "info": {
    "name": "ScriptToFrame API",
    "version": "1.0.0"
  },
  "item": [
    {
      "name": "å¥åº·æ£€æŸ¥",
      "request": {
        "method": "GET",
        "url": "{{base_url}}/api/health"
      }
    },
    {
      "name": "AIæ™ºèƒ½åˆ†æ",
      "request": {
        "method": "POST",
        "url": "{{base_url}}/api/intelligent-analyze-script",
        "body": {
          "mode": "raw",
          "raw": "{\n  \"script\": \"å¼ ä¸‰ç«™åœ¨å±±é¡¶ï¼Œå‡è§†è¿œæ–¹çš„å¤•é˜³...\",\n  \"sceneCount\": 3,\n  \"style\": \"anime\",\n  \"genre\": \"xuanhuan\"\n}"
        },
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ]
      }
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:3000"
    }
  ]
}
```

**curlæµ‹è¯•å‘½ä»¤**:
```bash
# å¥åº·æ£€æŸ¥
curl -X GET http://localhost:3000/api/health

# AIåˆ†ææ¥å£æµ‹è¯•
curl -X POST http://localhost:3000/api/intelligent-analyze-script \
  -H "Content-Type: application/json" \
  -d '{
    "script": "å¼ ä¸‰ç«™åœ¨å±±é¡¶ï¼Œè¿œå¤„å¤•é˜³è¥¿ä¸‹ã€‚ä»–è½¬èº«å¯¹å°çº¢è¯´ï¼šæˆ‘ä»¬å›å»å§ã€‚",
    "sceneCount": 2,
    "style": "anime",
    "genre": "romance"
  }' | jq .

# Pythonåç«¯å›¾ç‰‡ç”Ÿæˆæµ‹è¯•
curl -X POST http://localhost:8081/api/generate-image \
  -H "Content-Type: application/json" \
  -d '{
    "prompt": "Masterpiece, anime style, young man standing on mountain peak, sunset lighting --ar 16:9"
  }' | jq .
```

### 4. å•å…ƒæµ‹è¯• (å¯é€‰æ‰©å±•)

**Jestæµ‹è¯•é…ç½®**:
```javascript
// __tests__/components/ScriptInput.test.js
import { render, screen, fireEvent } from '@testing-library/react';
import ScriptInput from '../components/ScriptInput';

describe('ScriptInput', () => {
  test('renders input field', () => {
    render(
      <ScriptInput
        value=""
        onChange={() => {}}
        onValidate={() => {}}
      />
    );

    const textarea = screen.getByRole('textbox');
    expect(textarea).toBeInTheDocument();
  });

  test('validates input length', () => {
    const mockValidate = jest.fn();

    render(
      <ScriptInput
        value=""
        onChange={() => {}}
        onValidate={mockValidate}
      />
    );

    const textarea = screen.getByRole('textbox');
    fireEvent.change(textarea, { target: { value: 'short' } });

    expect(mockValidate).toHaveBeenCalledWith(false, expect.any(String));
  });
});
```

**Pythonæµ‹è¯•ç¤ºä¾‹**:
```python
# test_main.py
import pytest
from fastapi.testclient import TestClient
from main import app

client = TestClient(app)

def test_health_check():
    """æµ‹è¯•å¥åº·æ£€æŸ¥æ¥å£"""
    response = client.get("/api/health")
    assert response.status_code == 200
    assert response.json()["status"] == "healthy"

def test_generate_image():
    """æµ‹è¯•å›¾ç‰‡ç”Ÿæˆæ¥å£"""
    test_data = {
        "prompt": "test prompt"
    }

    response = client.post("/api/generate-image", json=test_data)
    assert response.status_code == 200

    result = response.json()
    assert result["success"] is True
```

## Gitå·¥ä½œæµç¨‹

### 1. åˆ†æ”¯ç­–ç•¥

```
master/main     â† ç”Ÿäº§åˆ†æ”¯ (åªæ¥å—Releaseåˆ†æ”¯çš„åˆå¹¶)
    â”‚
    â”œâ”€ release/v1.1.0    â† å‘å¸ƒåˆ†æ”¯
    â”‚       â”‚
    â”‚       â”œâ”€ feature/ai-analysis-optimization    â† åŠŸèƒ½åˆ†æ”¯
    â”‚       â”œâ”€ feature/ui-improvements             â† åŠŸèƒ½åˆ†æ”¯
    â”‚       â””â”€ hotfix/api-timeout-fix              â† çƒ­ä¿®å¤åˆ†æ”¯
    â”‚
    â””â”€ develop      â† å¼€å‘åˆ†æ”¯ (é›†æˆåˆ†æ”¯)
            â”‚
            â”œâ”€ feature/new-api-integration
            â”œâ”€ feature/performance-optimization
            â””â”€ bugfix/memory-leak-fix
```

### 2. æäº¤è§„èŒƒ

**Conventional Commitsæ ¼å¼**:
```bash
<type>[optional scope]: <description>

[optional body]

[optional footer(s)]
```

**æäº¤ç±»å‹**:
```bash
feat:     æ–°åŠŸèƒ½
fix:      ä¿®å¤bug
docs:     æ–‡æ¡£ä¿®æ”¹
style:    ä»£ç æ ¼å¼ä¿®æ”¹
refactor: ä»£ç é‡æ„
perf:     æ€§èƒ½ä¼˜åŒ–
test:     æµ‹è¯•ç›¸å…³
build:    æ„å»ºç›¸å…³
ci:       CI/CDç›¸å…³
chore:    å…¶ä»–ä¿®æ”¹
```

**æäº¤ç¤ºä¾‹**:
```bash
# åŠŸèƒ½å¼€å‘
git commit -m "feat(api): add intelligent script analysis endpoint

- Implement 4-step analysis workflow
- Add DeepSeek API integration
- Support multiple script formats

Closes #123"

# Bugä¿®å¤
git commit -m "fix(frontend): resolve progress bar animation issue

The progress bar was not updating correctly during batch generation.
Fixed by updating the state management logic.

Fixes #456"

# æ–‡æ¡£æ›´æ–°
git commit -m "docs: update API documentation with new endpoints"
```

### 3. å¼€å‘å·¥ä½œæµ

**åˆ›å»ºæ–°åŠŸèƒ½åˆ†æ”¯**:
```bash
# ä»developåˆ†æ”¯åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
git checkout develop
git pull origin develop
git checkout -b feature/new-feature-name

# å¼€å‘ä»£ç ...
git add .
git commit -m "feat: implement new feature"

# æ¨é€åˆ°è¿œç¨‹
git push -u origin feature/new-feature-name
```

**åˆå¹¶ä»£ç **:
```bash
# 1. æ›´æ–°æœ¬åœ°developåˆ†æ”¯
git checkout develop
git pull origin develop

# 2. åˆå¹¶æœ€æ–°ä»£ç åˆ°åŠŸèƒ½åˆ†æ”¯
git checkout feature/new-feature-name
git merge develop

# 3. è§£å†³å†²çª (å¦‚æœæœ‰)
# ç¼–è¾‘å†²çªæ–‡ä»¶...
git add .
git commit -m "resolve merge conflicts"

# 4. æ¨é€æ›´æ–°
git push origin feature/new-feature-name

# 5. åˆ›å»ºPull Request/Merge Request
```

**ä»£ç å®¡æŸ¥æ¸…å•**:
```markdown
## ä»£ç å®¡æŸ¥æ¸…å•

### åŠŸèƒ½æ€§
- [ ] åŠŸèƒ½æŒ‰éœ€æ±‚æ­£ç¡®å®ç°
- [ ] è¾¹ç•Œæƒ…å†µå¤„ç†å®Œå–„
- [ ] é”™è¯¯å¤„ç†é€‚å½“
- [ ] æ€§èƒ½è¡¨ç°è‰¯å¥½

### ä»£ç è´¨é‡
- [ ] ä»£ç ç»“æ„æ¸…æ™°
- [ ] å‘½åè§„èŒƒä¸€è‡´
- [ ] æ³¨é‡Šå……åˆ†æ°å½“
- [ ] éµå¾ªé¡¹ç›®ç¼–ç è§„èŒƒ

### å®‰å…¨æ€§
- [ ] è¾“å…¥éªŒè¯å®Œæ•´
- [ ] æ•æ„Ÿæ•°æ®ä¿æŠ¤
- [ ] APIå¯†é’¥å®‰å…¨
- [ ] æ— æ˜æ˜¾å®‰å…¨æ¼æ´

### æµ‹è¯•
- [ ] æ ¸å¿ƒåŠŸèƒ½æœ‰æµ‹è¯•è¦†ç›–
- [ ] æµ‹è¯•ç”¨ä¾‹å……åˆ†
- [ ] æµ‹è¯•é€šè¿‡
- [ ] æ— å›å½’é—®é¢˜
```

## æ€§èƒ½ä¼˜åŒ–

### 1. å‰ç«¯æ€§èƒ½ä¼˜åŒ–

**ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½**:
```javascript
// ä½¿ç”¨åŠ¨æ€å¯¼å…¥è¿›è¡Œä»£ç åˆ†å‰²
import dynamic from 'next/dynamic';

// æ‡’åŠ è½½é‡å‹ç»„ä»¶
const StoryboardDisplay = dynamic(
  () => import('../components/StoryboardDisplay'),
  {
    loading: () => <div className="cyber-spinner">Loading...</div>,
    ssr: false
  }
);

// æ¡ä»¶æ€§åŠ è½½
const AdminPanel = dynamic(
  () => import('../components/AdminPanel'),
  {
    loading: () => <p>Loading admin panel...</p>
  }
);
```

**å›¾ç‰‡ä¼˜åŒ–**:
```javascript
// ä½¿ç”¨Next.js Imageç»„ä»¶
import Image from 'next/image';

const FrameDisplay = ({ imageUrl, alt }) => {
  return (
    <div className="relative aspect-video">
      <Image
        src={imageUrl}
        alt={alt}
        fill
        sizes="(max-width: 768px) 100vw, 50vw"
        className="object-cover"
        placeholder="blur"
        blurDataURL="data:image/jpeg;base64,/9j/4AAQSkZJRg..."
        loading="lazy"
      />
    </div>
  );
};
```

**çŠ¶æ€ç®¡ç†ä¼˜åŒ–**:
```javascript
import { useMemo, useCallback } from 'react';

const StoryboardDisplay = ({ frames }) => {
  // ä½¿ç”¨useMemoé¿å…é‡å¤è®¡ç®—
  const frameStats = useMemo(() => {
    return {
      total: frames.length,
      completed: frames.filter(f => f.imageUrl).length,
      generating: frames.filter(f => f.isGenerating).length
    };
  }, [frames]);

  // ä½¿ç”¨useCallbacké¿å…é‡å¤æ¸²æŸ“
  const handleFrameRegenerate = useCallback((frameId) => {
    setFrames(prevFrames =>
      prevFrames.map(frame =>
        frame.id === frameId
          ? { ...frame, isGenerating: true }
          : frame
      )
    );
  }, []);

  return (
    <div>
      <div className="stats">
        æ€»è®¡: {frameStats.total},
        å·²å®Œæˆ: {frameStats.completed}
      </div>
      {/* å…¶ä»–å†…å®¹ */}
    </div>
  );
};
```

### 2. åç«¯æ€§èƒ½ä¼˜åŒ–

**å¼‚æ­¥å¤„ç†ä¼˜åŒ–**:
```python
import asyncio
from concurrent.futures import ThreadPoolExecutor

# ä½¿ç”¨çº¿ç¨‹æ± å¤„ç†CPUå¯†é›†å‹ä»»åŠ¡
executor = ThreadPoolExecutor(max_workers=4)

async def process_multiple_frames(frames: List[dict]):
    """å¹¶è¡Œå¤„ç†å¤šä¸ªå¸§"""
    tasks = []

    for frame in frames:
        # åˆ›å»ºå¼‚æ­¥ä»»åŠ¡
        task = asyncio.create_task(
            generate_single_frame(frame)
        )
        tasks.append(task)

    # ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆ
    results = await asyncio.gather(*tasks, return_exceptions=True)

    return results

async def generate_single_frame(frame: dict):
    """ç”Ÿæˆå•ä¸ªå¸§"""
    # ä½¿ç”¨çº¿ç¨‹æ± æ‰§è¡ŒåŒæ­¥æ“ä½œ
    loop = asyncio.get_event_loop()
    result = await loop.run_in_executor(
        executor,
        sync_image_processing,
        frame
    )
    return result
```

**å†…å­˜ç®¡ç†**:
```python
import gc
import psutil
import logging

def monitor_memory_usage():
    """ç›‘æ§å†…å­˜ä½¿ç”¨æƒ…å†µ"""
    process = psutil.Process()
    memory_info = process.memory_info()

    logging.info(f"Memory usage: {memory_info.rss / 1024 / 1024:.2f} MB")

    # å½“å†…å­˜ä½¿ç”¨è¶…è¿‡é˜ˆå€¼æ—¶è§¦å‘åƒåœ¾å›æ”¶
    if memory_info.rss > 500 * 1024 * 1024:  # 500MB
        logging.warning("High memory usage detected, triggering GC")
        gc.collect()

# åœ¨APIå¤„ç†å®Œæˆåæ¸…ç†èµ„æº
@app.middleware("http")
async def cleanup_middleware(request: Request, call_next):
    response = await call_next(request)

    # å®šæœŸç›‘æ§å†…å­˜
    if request.url.path.startswith("/api/generate"):
        monitor_memory_usage()

    return response
```

**ç¼“å­˜ç­–ç•¥**:
```python
from functools import lru_cache
import hashlib
import json

class ResultCache:
    def __init__(self, max_size=1000):
        self.cache = {}
        self.max_size = max_size

    def get_cache_key(self, data: dict) -> str:
        """ç”Ÿæˆç¼“å­˜é”®"""
        json_str = json.dumps(data, sort_keys=True)
        return hashlib.md5(json_str.encode()).hexdigest()

    def get(self, key: str):
        """è·å–ç¼“å­˜å€¼"""
        return self.cache.get(key)

    def set(self, key: str, value):
        """è®¾ç½®ç¼“å­˜å€¼"""
        if len(self.cache) >= self.max_size:
            # åˆ é™¤æœ€è€çš„ç¼“å­˜é¡¹
            oldest_key = next(iter(self.cache))
            del self.cache[oldest_key]

        self.cache[key] = value

# å…¨å±€ç¼“å­˜å®ä¾‹
cache = ResultCache()

async def generate_image_with_cache(prompt: str):
    """å¸¦ç¼“å­˜çš„å›¾ç‰‡ç”Ÿæˆ"""
    cache_key = cache.get_cache_key({"prompt": prompt})

    # æ£€æŸ¥ç¼“å­˜
    cached_result = cache.get(cache_key)
    if cached_result:
        logging.info(f"Cache hit for prompt: {prompt[:50]}...")
        return cached_result

    # ç”Ÿæˆå›¾ç‰‡
    result = await generate_image_without_cache(prompt)

    # ç¼“å­˜ç»“æœ
    cache.set(cache_key, result)

    return result
```

## è´¡çŒ®æŒ‡å—

### 1. è´¡çŒ®æµç¨‹

**å¼€å§‹è´¡çŒ®**:
```bash
# 1. Forké¡¹ç›®åˆ°ä¸ªäººè´¦æˆ·
# 2. å…‹éš†Forkçš„ä»“åº“
git clone https://github.com/your-username/script-to-frame.git
cd script-to-frame

# 3. æ·»åŠ ä¸Šæ¸¸ä»“åº“
git remote add upstream https://github.com/original/script-to-frame.git

# 4. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
git checkout -b feature/your-feature-name

# 5. å¼€å‘åŠŸèƒ½...
# 6. æäº¤ä»£ç 
git add .
git commit -m "feat: add new feature"

# 7. æ¨é€åˆ°ä¸ªäººä»“åº“
git push origin feature/your-feature-name

# 8. åˆ›å»ºPull Request
```

**Pull Requestæ¨¡æ¿**:
```markdown
## åŠŸèƒ½æè¿°
ç®€è¦æè¿°æœ¬æ¬¡PRçš„åŠŸèƒ½æˆ–ä¿®æ”¹å†…å®¹ã€‚

## å˜æ›´ç±»å‹
- [ ] æ–°åŠŸèƒ½ (feat)
- [ ] Bugä¿®å¤ (fix)
- [ ] æ–‡æ¡£æ›´æ–° (docs)
- [ ] æ ·å¼ä¿®æ”¹ (style)
- [ ] ä»£ç é‡æ„ (refactor)
- [ ] æ€§èƒ½ä¼˜åŒ– (perf)
- [ ] æµ‹è¯•ç›¸å…³ (test)
- [ ] æ„å»ºç›¸å…³ (build)

## æµ‹è¯•æ¸…å•
- [ ] æœ¬åœ°æµ‹è¯•é€šè¿‡
- [ ] å•å…ƒæµ‹è¯•é€šè¿‡ (å¦‚é€‚ç”¨)
- [ ] é›†æˆæµ‹è¯•é€šè¿‡ (å¦‚é€‚ç”¨)
- [ ] æ‰‹åŠ¨æµ‹è¯•é€šè¿‡

## ç›¸å…³Issue
Closes #issue_number

## æˆªå›¾ (å¦‚é€‚ç”¨)
å¦‚æœæ˜¯UIç›¸å…³çš„ä¿®æ”¹ï¼Œè¯·æä¾›å‰åå¯¹æ¯”æˆªå›¾ã€‚

## å…¶ä»–è¯´æ˜
ä»»ä½•éœ€è¦ç‰¹åˆ«è¯´æ˜çš„å†…å®¹ã€‚
```

### 2. ä»£ç å®¡æŸ¥æ ‡å‡†

**è‡ªæ£€æ¸…å•**:
```markdown
## æäº¤å‰è‡ªæ£€æ¸…å•

### ä»£ç è´¨é‡
- [ ] ä»£ç ç¬¦åˆé¡¹ç›®ç¼–ç è§„èŒƒ
- [ ] åˆ é™¤äº†è°ƒè¯•ä»£ç å’Œconsole.log
- [ ] å˜é‡å’Œå‡½æ•°å‘½åæ¸…æ™°æœ‰æ„ä¹‰
- [ ] å¤æ‚é€»è¾‘æœ‰é€‚å½“æ³¨é‡Š

### åŠŸèƒ½æµ‹è¯•
- [ ] æ ¸å¿ƒåŠŸèƒ½æ­£å¸¸å·¥ä½œ
- [ ] é”™è¯¯æƒ…å†µå¤„ç†æ­£ç¡®
- [ ] è¾¹ç•Œæ¡ä»¶è€ƒè™‘å‘¨å…¨
- [ ] æ€§èƒ½è¡¨ç°å¯æ¥å—

### å…¼å®¹æ€§
- [ ] æ”¯æŒä¸»è¦æµè§ˆå™¨ (Chrome, Firefox, Safari)
- [ ] å“åº”å¼è®¾è®¡é€‚é…ç§»åŠ¨ç«¯
- [ ] å‘åå…¼å®¹ç°æœ‰API

### æ–‡æ¡£
- [ ] æ›´æ–°äº†ç›¸å…³æ–‡æ¡£
- [ ] APIå˜æ›´æœ‰è¯´æ˜
- [ ] å¤æ‚ç®—æ³•æœ‰æ³¨é‡Š
```

### 3. å‘å¸ƒæµç¨‹

**ç‰ˆæœ¬å·è§„èŒƒ (Semantic Versioning)**:
```
MAJOR.MINOR.PATCH

MAJOR: ä¸å…¼å®¹çš„APIä¿®æ”¹
MINOR: å‘åå…¼å®¹çš„åŠŸèƒ½æ–°å¢
PATCH: å‘åå…¼å®¹çš„é—®é¢˜ä¿®æ­£

ç¤ºä¾‹:
1.0.0 â†’ 1.0.1 (bugä¿®å¤)
1.0.1 â†’ 1.1.0 (æ–°åŠŸèƒ½)
1.1.0 â†’ 2.0.0 (ç ´åæ€§å˜æ›´)
```

**å‘å¸ƒæ­¥éª¤**:
```bash
# 1. æ›´æ–°ç‰ˆæœ¬å·
npm version patch  # æˆ– minor, major

# 2. æ›´æ–°CHANGELOG.md
echo "## [1.0.1] - 2025-12-24
### Fixed
- ä¿®å¤å›¾ç‰‡ç”Ÿæˆè¶…æ—¶é—®é¢˜
- ä¼˜åŒ–å†…å­˜ä½¿ç”¨

### Added
- æ–°å¢æ‰¹é‡ä¸‹è½½åŠŸèƒ½" >> CHANGELOG.md

# 3. åˆ›å»ºå‘å¸ƒåˆ†æ”¯
git checkout -b release/v1.0.1

# 4. æäº¤å‘å¸ƒå‡†å¤‡
git add .
git commit -m "chore: prepare release v1.0.1"

# 5. åˆå¹¶åˆ°mainåˆ†æ”¯
git checkout main
git merge release/v1.0.1

# 6. åˆ›å»ºæ ‡ç­¾
git tag -a v1.0.1 -m "Release v1.0.1"

# 7. æ¨é€åˆ°è¿œç¨‹
git push origin main --tags

# 8. åˆå¹¶å›developåˆ†æ”¯
git checkout develop
git merge main
git push origin develop
```

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0
**æœ€åæ›´æ–°**: 2025-12-24
**ç»´æŠ¤è€…**: ScriptToFrame Team